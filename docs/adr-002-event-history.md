# ADR 3 — 状態変更の履歴を個別テーブルで保持

- **ステータス**: 採用
- **コンテキスト**: Todo の状態は「未着手」「着手中」「完了」と遷移していく。状態の変更だけで更新するのではなく、いつどの状態になったかを遡れるようにしたい。アプリ全体でイベントログを集約する方法を検討したが、単純なリレーショナルテーブルに追加ログとして残す方が管理しやすかった。
- **決定**: `PostgresDriver` は `todo.item_created` / `todo.item_started` / `todo.item_completed` の 3 つのテーブルに対して、状態遷移ごとに `INSERT` を行う。`TodoItemGateway` はこれらのテーブルから日時を全部読み出して `TodoItemEvent` の一覧を再構築し、`TodoItem` に含める。イベントを全件保持することで `TodoItems` や `TodoItem` のインスタンスは履歴を知った上で返せる。
- **結果**: いつ何回状態が変わったかがログとして残り、将来的に「いつから着手したか」「完了までの所要時間」などの集計に使いやすい。リードモデル的な処理が Gateway 側で完結するため、他の層に波及せずに継続できる。

